script src="http://d3js.org/d3.v3.min.js"
css:
  .node {
    stroke: #fff;
    stroke-width: 1.5px;
  }

  .link {
    stroke: #999;
    stroke-opacity: .6;
  }
.container
  = render partial: "layouts/navbar"
  .row
    .col-md-12 style="border:1px blue solid;"
      p below data is provided by controller
      = @graph_data
      #fg

    javascript:
      $.get('/data1',function(graph){

        var width = 600,
                height = 400;

        var color = d3.scale.category20();

        var force = d3.layout.force()
                /*.charge(-120)
                .linkDistance(30)*/
                .linkStrength(0.3)
                .friction(0.9)
                .linkDistance(100)
                .chargeDistance(-100)
                .charge(-1000)
                .gravity(0.05)/*0.1*/
                /*.theta(0.8)*/
                .alpha(0)
                .size([width, height]);

        var svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height);

        force.nodes(graph.nodes)
                .links(graph.links)
                .start();

        var link = svg.selectAll(".link")
                .data(graph.links)
                .enter().append("line")
                .attr("class", "link")
                .style("stroke-width", 1)

        var node = svg.selectAll(".node")
                .data(graph.nodes)
                .enter().append("circle")
                .attr("class", "node")
                .attr({r: 15, opacity: 0.5})
                .style("fill", function (d) {
                  if(Math.random()> 0.5){
                    return "red";
                  } else{
                    return "green";
                  }
                })
                .call(force.drag);

        var label = svg.selectAll("text")
                .data(graph.nodes)
                .enter()
                .append("text")
                .attr({"text-ancher": "middle", "fill": "black"})
                .style({"font-size": 14})
                .text(function (d) {
                  return d.label
                })
                .call(force.drag);

        node.append("title")
                .text(function (d) {
                  return "FOOBOO";
                  /*return d.name;*/
                });

        force.on("tick", function () {
          link.attr("x1", function (d) {
            return d.source.x;
          })
                  .attr("y1", function (d) {
                    return d.source.y;
                  })
                  .attr("x2", function (d) {
                    return d.target.x;
                  })
                  .attr("y2", function (d) {
                    return d.target.y;
                  });

          node.attr("cx", function (d) {
            return d.x;
          })
                  .attr("cy", function (d) {
                    return d.y;
                  });
          label.attr({
            x: function (d) {
              return d.x - 7;
            },
            y: function (d) {
              return d.y + 7;
            }
          });
        });
      })